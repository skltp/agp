<?xml version="1.0" encoding="utf-8" standalone="no"?>
<mule
        xmlns="http://www.mulesoft.org/schema/mule/core"
        xmlns:http="http://www.mulesoft.org/schema/mule/http"
        xmlns:jms="http://www.mulesoft.org/schema/mule/jms"
        xmlns:json="http://www.mulesoft.org/schema/mule/json"
        xmlns:mulexml="http://www.mulesoft.org/schema/mule/xml"
        xmlns:scripting="http://www.mulesoft.org/schema/mule/scripting"
        xmlns:spring="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="
	   http://www.springframework.org/schema/beans     http://www.springframework.org/schema/beans/spring-beans-current.xsd
	   http://www.mulesoft.org/schema/mule/core        http://www.mulesoft.org/schema/mule/core/current/mule.xsd
	   http://www.mulesoft.org/schema/mule/jms         http://www.mulesoft.org/schema/mule/jms/current/mule-jms.xsd
	   http://www.mulesoft.org/schema/mule/json        http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
	   http://www.mulesoft.org/schema/mule/scripting   http://www.mulesoft.org/schema/mule/scripting/current/mule-scripting.xsd
	   http://www.mulesoft.org/schema/mule/xml         http://www.mulesoft.org/schema/mule/xml/current/mule-xml.xsd
	   http://www.mulesoft.org/schema/mule/http        http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
	">



    <spring:bean name="takService" class="se.skltp.takcache.services.TakServiceImpl">
        <spring:constructor-arg index="0" value="${TAK_OUTBOUND_URL}"/>
        <spring:constructor-arg index="1" value="${takcache.header.user.agent}"/>
    </spring:bean>

    <spring:bean name="takCacheBean" class="se.skltp.takcache.TakCacheImpl">
        <spring:constructor-arg index="0" ref="takService"/>
    </spring:bean>

    <spring:bean name="hsaCacheBean" class="se.skl.tp.hsa.cache.HsaCacheImpl"/>

    <spring:bean name="muleStartupNotification"
                 class="se.skltp.agp.cache.MuleStartupNotificationHandler">
        <spring:property name="takCache" ref="takCacheBean"/>
        <spring:property name="hsaCache" ref="hsaCacheBean"/>
        <spring:property name="hsaFiles" value="${HSA_FILES}"/>
        <spring:property name="tjanstekontrakt" value="${TAK_TJANSTEKONTRAKT}"/>
    </spring:bean>

    <spring:bean name="defaultRoutingConfiguration" class="se.skl.tp.DefaultRoutingConfigurationImpl">
        <spring:property name="delimiter" value="${DEPRECATED_DEAFAULT_ROUTING_DELIMITER}"/>
        <spring:property name="allowedContractsAsString" value="${DEPRECATED_DEFAULT_ROUTING_CONTRACTS:''}"/>
        <spring:property name="allowedSenderIdsAsString" value="${DEPRECATED_DEFAULT_ROUTING_SENDERS:''}"/>
    </spring:bean>

    <spring:bean name="anslutningCache" class="se.skltp.agp.cache.AnslutningCacheBean">
        <spring:constructor-arg index="0" ref="hsaCacheBean"/>
        <spring:constructor-arg index="1" ref="takCacheBean"/>
        <spring:constructor-arg index="2" ref="defaultRoutingConfiguration"/>

        <spring:property name="servicecontractNamespace" value="${TAK_TJANSTEKONTRAKT}" />
        <spring:property name="agpHsaId" value="${AGP_HSA_ID}"/>
        </spring:bean>

</mule>